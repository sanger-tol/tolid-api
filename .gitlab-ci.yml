# SPDX-FileCopyrightText: 2021 Genome Research Ltd.
#
# SPDX-License-Identifier: MIT

include:
  - project: 'tol/tol-core'

    ref: '68663688272af3a740babead2dc3ad199c760741' # TODO change back!!!!

    file: '/gitlab/main.yml'

variables:
  APP_NAME: "tolid"
  SERVICE_NAME: "id"
  ENABLE_ROBOT_REVIEW: "true"



# DELETE below here!!
  CI_COMMIT_SHA: "bb9d32fd493f4b1b98e62552dd3e14e835b691a5"


stages:
  - lint
  - build
  - unit test
  - system test
  - review
  - integration test
  - cleanup
  - deploy


review_app:
  extends: .review_app
  rules:
    - if: $DISABLE_REVIEW_APPS
      when: never
    - if: $CI_COMMIT_BRANCH =~ /^TOLP-.*$/

test-robot:
  extends: .test-robot
  needs: ["review_app", "build-robot"]
  dependencies: ["review_app"]

stop_review:
  extends: .stop_review
  rules:
    - if: $DISABLE_REVIEW_APPS
      when: never
    - if: $CI_COMMIT_BRANCH =~ /^TOLP-.*$/
      when: manual

